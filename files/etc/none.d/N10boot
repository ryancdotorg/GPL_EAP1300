#!/bin/sh /etc/rc.common
# Copyright (C) 2006-2011 OpenWrt.org

NONE=10


enable_console_login() {
        local cons=$1
        local initline
        if [ -e /bin/login ]; then
                initline="$cons::askfirst:/bin/login"
        else
                initline="$cons::askfirst:/bin/ash --login"
        fi;

        grep -qs "^$initline" /etc/inittab || {
                echo "$initline" >> /etc/inittab
                sync
                kill -HUP 1
        }
}


inittab_console_fixup() {
        for cons in ttyS0 ttyATH0; do
                grep -qs "console=$cons" /proc/cmdline && {
                        enable_console_login $cons
                }
        done
}

start() {
	inittab_console_fixup
}
